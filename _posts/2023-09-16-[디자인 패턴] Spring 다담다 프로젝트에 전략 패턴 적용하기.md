---
title: "[ë””ìì¸ íŒ¨í„´] Spring ë‹¤ë‹´ë‹¤ í”„ë¡œì íŠ¸ì— ì „ëµ íŒ¨í„´ ì ìš©í•˜ê¸°"
date: 2023-09-16
categories: [Design Pattern, Strategy]
---
# 0ï¸âƒ£ ì„œë¡ 

## ğŸ“„ í˜„ì¬ í”„ë¡œì íŠ¸ êµ¬ì¡°

í˜„ì¬ Scrapì´ë¼ëŠ” ë¶€ëª¨ í´ë˜ìŠ¤ë¡œ Video, Product, Article, Place, Other ì¹´í…Œê³ ë¦¬ì˜ ìì‹ í´ë˜ìŠ¤ê°€ ìˆìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ê°ê°ì˜ ìì‹ í´ë˜ìŠ¤ëŠ” ê°ê°ì˜ Entityë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ, ìƒì† ê´€ê³„ì— ìˆëŠ” ë§Œí¼ ì¡°íšŒ ê¸°ëŠ¥, ê²€ìƒ‰ ê¸°ëŠ¥, ìˆ˜ì • ê¸°ëŠ¥ ë“± ê°ê°ì˜ Video, Product, Article, Place, Other ì¹´í…Œê³ ë¦¬ëŠ” ê¸°ëŠ¥ì´ ê±°ì˜ ìœ ì‚¬í•©ë‹ˆë‹¤.

![Alt text](/assets/img/2023-09-16/image.png)


ê·¸ëŸ¬ë‚˜, ê°ê°ì€ ë‹¤ë¥¸ Repositoryì™€ Service, Controllerë¥¼ ê°€ì§€ê³  ìˆê¸° ë–„ë¬¸ì— ArticleController, OtherController, ProductController, VideoControllerì—ì„œëŠ” ë™ì¼í•œ ê¸°ëŠ¥ì´ì–´ë„ ì•„ë˜ì™€ ê°™ì´ ë”°ë¡œ ê°ì ë¶„ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.


```java
@Operation(summary = "ì•„í‹°í´ ìŠ¤í¬ë© ê°œìˆ˜ ì¡°íšŒ", description = "ì•„í‹°í´ ìŠ¤í¬ë© ê°œìˆ˜ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
@GetMapping("/v1/scraps/articles/count")
public ApiResponse<GetArticleCountResponse> getArticleCount(Authentication authentication) {
    String email = authentication.getName();
    return ApiResponse.success(
            GetArticleCountResponse.of(articleService.getArticleCount(email)));
}

@Operation(summary = "ê¸°íƒ€ ìŠ¤í¬ë© ê°œìˆ˜ ì¡°íšŒ", description = "ê¸°íƒ€ ìŠ¤í¬ë© ê°œìˆ˜ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
@GetMapping("/v1/scraps/others/count")
public ApiResponse<GetOtherCountResponse> getOtherScrap(Authentication authentication) {
    String email = authentication.getName();
    return ApiResponse.success(GetOtherCountResponse.of(otherService.getOtherCount(email)));
}

@Operation(summary = "ìƒí’ˆ ìŠ¤í¬ë© ê°œìˆ˜ ì¡°íšŒ", description = "ìƒí’ˆ ìŠ¤í¬ë© ê°œìˆ˜ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
@GetMapping("/v1/scraps/products/count")
public ApiResponse<GetProductCountResponse> getProductScrap(Authentication authentication) {
    String email = authentication.getName();
    return ApiResponse.success(
            GetProductCountResponse.of(productService.getProductCount(email)));
}

@Operation(summary = "ë¹„ë””ì˜¤ ìŠ¤í¬ë© ê°œìˆ˜ ì¡°íšŒ", description = "ë¹„ë””ì˜¤ ìŠ¤í¬ë© ê°œìˆ˜ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
@GetMapping("/v1/scraps/videos/count")
public ApiResponse<GetVideoCountResponse> getVideoCount(Authentication authentication) {
    String email = authentication.getName();
    return ApiResponse.success(GetVideoCountResponse.of(videoService.getVideoCount(email)));
}

```
ì´ ë•Œì˜ ë‹¨ì ì€ ë™ì¼í•œ ê¸°ëŠ¥ì„ ë‚˜ëˆ ì„œ ì‘ì„±í–ˆê¸° ë•Œë¬¸ì— **ì½”ë“œì˜ ê¸¸ì´ê°€ ê¸¸ì–´ì§„ë‹¤**ëŠ” ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤.

ì €í¬ ì„œë¹„ìŠ¤ëŠ” ì¹´í…Œê³ ë¦¬ê°€ ì ì°¨ ëŠ˜ì–´ë‚  ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì— ê·¸ëŸ´ ë•Œë§ˆë‹¤ ë™ì¼í•œ ë¡œì§ì´ ê³„ì†ë˜ì–´ì„œ ì¶”ê°€ë©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜, ì œê°€ ìƒê°í•œ ê°€ì¥ í° ë‹¨ì ì€ "**í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì‹œ ë™ì¼í•œ ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•˜ê²Œ ëœë‹¤**"ë¼ëŠ” ì ì…ë‹ˆë‹¤.

ì¦‰, í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì‹œì— ì¹´í…Œê³ ë¦¬ì˜ ìŠ¤í¬ë© ê°œìˆ˜ë¥¼ ì¡°íšŒí•˜ëŠ” ê°™ì€ ê¸°ëŠ¥ë„ Controllerì˜ ë©”ì†Œë“œë¡œ ë‚˜ëˆ„ì–´ì ¸ ìˆê¸° ë•Œë¬¸ì— ê°ê°ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. 

ê·¸ëŸ¬ë‚˜, í•œ ê°œì˜ Controllerë¥¼ í…ŒìŠ¤íŠ¸ ì™„ë£Œí•˜ë©´ ë‹¤ë¥¸ Controllerì˜ ë©”ì†Œë“œë„ ë™ì¼í•œ ë¡œì§ì´ê¸° ë•Œë¬¸ì— ë™ì¼í•œ ê²°ê³¼ê°€ ë‚˜ì˜¬ì§€ ì•Œ ìˆ˜ ìˆì§€ë§Œ ì»¤ë²„ë¦¬ì§€ ë° í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ìœ„í•´ì„œëŠ” ë™ì¼í•œ ë¡œì§ë„ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•œë‹¤ëŠ” ë‹¨ì ì´ ìˆì—ˆìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ì´ êµ¬ì¡°ë¥¼ refactoringí•˜ëŠ” ê³¼ì •ì„ ì†Œê°œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤!

---
# 1ï¸âƒ£ ë³¸ë¡  1
## ğŸ–ï¸ if ë¬¸ ì‚¬ìš©í•˜ê¸°

ğŸ¥¹ ì—¬ê¸°ì„œ ì ê¹, ì—¬ê¸°ì—ì„œ ifë¬¸ì„ ì‚¬ìš©í•´ì„œ í•˜ë‚˜ì˜ Controller methodë¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆë ê¹Œìš”??

```java
@RequiredArgsConstructor
@RestController
public class ScrapController {

    @GetMapping("/v1/scraps/{category}/count")
    public ApiResponse<GetScrapCountResponse> getScrapCount(
            @NotNull @PathVariable Category category,
            Authentication authentication) {
        String email = authentication.getName();

        if(category == "video") {
            return ApiResponse.success(GetScrapCountResponse.of(videoService.getVideoCount(email)));
        } else if (category == "product") {
            return ApiResponse.success(GetScrapCountResponse.of(productService.getProductCount(email)));
        } else if (category == "other") {
            return ApiResponse.success(GetScrapCountResponse.of(otherService.getOtherCount(email)));
        }

        return ApiResponse.success(GetScrapCountResponse.of(scrapCount));
    }
}
``` 

ê·¸ëŸ¬ë©´ ì¹´í…Œê³ ë¦¬ê°€ ëŠ˜ì–´ë‚  ë•Œë§ˆë‹¤ Controllerì˜ ì½”ë“œë¥¼ ìˆ˜ì •í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤ ğŸ¥²

![Alt text](/assets/img/2023-09-16/image-2.jpg)

## ğŸ” SOLID ê°ì²´ ì§€í–¥ 5ê°€ì§€ ì„¤ê³„ ì›ì¹™
í˜¹ì‹œ SOLIDë¼ëŠ” **ê°ì²´ì§€í–¥ì„¤ê³„ì˜ ì›ì¹™**ì„ ë“¤ì–´ë³´ì…¨ë‚˜ìš”??

ì—¬ê¸°ì—ì„œ OëŠ” OCPë¡œ ê°œë°© íì‡„ ì›ì¹™ì…ë‹ˆë‹¤.
**í™•ì¥ì— ëŒ€í•´ëŠ” ì—´ë ¤ ìˆê³ , ìˆ˜ì •ì— ëŒ€í•´ì„œëŠ” ë‹«í˜€ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.**

ê·¸ëŸ°ë° ìœ„ì˜ ì½”ë“œì™€ ê°™ì´ ifë¬¸ì„ ì‚¬ìš©í•˜ë©´, **ìˆ˜ì •ì—ëŠ” ë‹«í˜€ ìˆëŠ” êµ¬ì¡°ê°€ ì•„ë‹Œ ê³„ì†í•´ì„œ ifë¬¸ì„ ì¶”ê°€í•´ì•¼ í•˜ëŠ” ìˆ˜ì •ì— ì—´ë ¤ìˆëŠ” êµ¬ì¡°**ê°€ ë©ë‹ˆë‹¤.

ê·¸ë¦¬ê³   DIP ì˜ì¡´ ê´€ê³„ ì—­ì „ ì›ì¹™ì„ ì—¬ê¸°ê²Œ ë©ë‹ˆë‹¤.
**DIPëŠ” ì¶”ìƒí™”ì— ì˜ì¡´í•´ì•¼ í•˜ê³ , êµ¬ì²´í™”ì— ì˜ì¡´í•˜ë©´ ì•ˆëœë‹¤**ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ì¦‰, ifë¬¸ìœ¼ë¡œ êµ¬ì²´í™” ë˜ì–´ ìˆëŠ” videoService, productService í´ë˜ìŠ¤ë¥¼ ì˜ì¡´í•˜ê²Œ ë©ë‹ˆë‹¤!!

---

# 2ï¸âƒ£ ë³¸ë¡  2
## ğŸ§šâ€â™€ï¸ í”„ë¡œì íŠ¸ì— ì „ëµ íŒ¨í„´ ì ìš©í•˜ê¸°

ê·¸ëŸ¬ë©´ ê³¼ì—° ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ì—†ì„ê¹Œ?? ë¼ëŠ” ê³ ë¯¼ì„ í•˜ë‹¤ê°€ **ì „ëµ íŒ¨í„´**ì„ ë– ì˜¬ë¦¬ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

ì´ì „ì— ë””ìì¸ íŒ¨í„´ìœ¼ë¡œ ì „ëµ íŒ¨í„´ì„ ê²Œì‹œê¸€ë¡œ ì˜¬ë ¸ë˜ ì ì´ ìˆìŠµë‹ˆë‹¤.

https://handayeon-coder.github.io/posts/ë””ìì¸-íŒ¨í„´-06.-Strategy-íŒ¨í„´/

ì´ë•Œ, ì•Œê³ ë¦¬ì¦˜ì˜ ë™ì‘ì´ ëŸ°íƒ€ì„ì— ì‹¤ì‹œê°„ìœ¼ë¡œ êµì²´ ë˜ì–´ì•¼ í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤ê³  í–ˆìŠµë‹ˆë‹¤.

ì•„ë˜ëŠ” ì „ëµ íŒ¨í„´ ë‹¤ì´ì–´ê·¸ë¨ì…ë‹ˆë‹¤!

![Alt text](/assets/img/2023-09-16/image-1.png)

ë”°ë¼ì„œ ì „ëµ íŒ¨í„´ì²˜ëŸ¼ Clientê°€ Controllerì— PathVariableë¡œ ì…ë ¥í•œ 
`@GetMapping("/v1/scraps/{category}/count")` categoryì— ë”°ë¼ì„œ videoService.getVideoCount, productService,getProductCountì™€ ê°™ì´ ì‹¤ì‹œê°„ìœ¼ë¡œ êµì²´ë˜ë©´ ë  ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì„ í–ˆìŠµë‹ˆë‹¤.

ì „ëµ íŒ¨í„´ ë‹¤ì´ì–´ê·¸ë¨ì„ ì €í¬ ì„œë¹„ìŠ¤ì—ë„ ì ìš©í•´ë³´ì•˜ìŠµë‹ˆë‹¤.

![Alt text](/assets/img/2023-09-16/image-8.png)

### 1. Strategy ì¸í„°í˜ì´ìŠ¤ ìƒì„±í•˜ê¸°
ë¨¼ì € *Strategy*ë¥¼ ì˜ë¯¸í•˜ëŠ” *ScrapService*ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ì–´ì£¼ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```java
public interface ScrapService {
    Long getScrapCount(String email);
}
```

### 2. ConcreteStrategyë¥¼ ì •ì˜í•˜ê¸°
ê°ê°ì˜ ConcretStrategyê°€ ë˜ëŠ” VideoService, ProductService, ArticleServiceì— getScrapCount ì „ëµ ë©”ì†Œë“œë¥¼ @Overrideí•´ì„œ ë‚˜íƒ€ë‚´ì¤ë‹ˆë‹¤. 
- (ì´ë•Œ, ë‹¤ë¥¸ PlaceService, OtherServiceëŠ” ë™ì¼í•œ ë¡œì§ì´ë¼ì„œ ì•„ë˜ì˜ ì½”ë“œì—ì„œ ìƒëµí•˜ì˜€ìŠµë‹ˆë‹¤.)

```java
@Service
@RequiredArgsConstructor
public class ProductService implements ScrapService {

    private final ProductRepository productRepository;
    private final UserService userService;

    @Override
    @Transactional
    public Long getScrapCount(String email) {
        User user = userService.validateUser(email);
        return productRepository.countByUserAndDeletedDateIsNull(user);
    }
}
```

```java
@Service
@RequiredArgsConstructor
public class ArticleService implements ScrapService {

    private final ArticleRepository articleRepository;
    private final UserService userService;

    @Override
    @Transactional
    public Long getScrapCount(String email) {
        User user = userService.validateUser(email);
        return articleRepository.countByUserAndDeletedDateIsNull(user);
    }
}
```

```java
@Service
@RequiredArgsConstructor
public class VideoService implements ScrapService {

    private final VideoRepository videoRepository;
    private final UserService userService;

    @Override
    @Transactional
    public Long getScrapCount(String email) {
        User user = userService.validateUser(email);
        return videoRepository.countByUserAndDeletedDateIsNull(user);
    }
}
```

### 3. Context í´ë˜ìŠ¤ì—ì„œ Strategy ì„ íƒí•˜ê¸°

```java
@RequiredArgsConstructor
@RestController
public class ScrapController {

    private final Map<String, ScrapService> scrapServices;

    @GetMapping("/v1/scraps/{category}/count")
    public ApiResponse<GetScrapCountResponse> getScrapCount(
            @NotNull @PathVariable Category category,
            Authentication authentication) {
        String email = authentication.getName();

        ScrapService scrapService = scrapServices.get(category.getServiceName());
        Long scrapCount = scrapService.getScrapCount(email);
        return ApiResponse.success(GetScrapCountResponse.of(scrapCount));
    }
}
``` 
- ì´ë•Œ, scrapServicesë¡œ ì„ íƒí•  ì „ëµì„ í•„ë“œì— ë‚˜íƒ€ë‚´ì¤ë‹ˆë‹¤.
- `@GetMapping("/v1/scraps/{category}/count")` 
    - @PathVariableë¡œ ì›í•˜ëŠ” Categoryë¥¼ ì…ë ¥ë°›ì•„ì¤ë‹ˆë‹¤.
- `ScrapService scrapService = scrapServices.get(category.getServiceName());` 
    - ì—¬ëŸ¬ ì „ëµ(VideoService, ProductService, ArticleService, PlaceService, TotalService)ì—ì„œ ì…ë ¥ëœ ì¹´í…Œê³ ë¦¬ì— í•´ë‹¹í•˜ëŠ” ì„œë¹„ìŠ¤ ë¡œì§ì„ ì„ íƒí•´ì¤ë‹ˆë‹¤. 


```java
@Getter
public enum Category {
    product("productService"),
    article("articleService"),
    place("placeService"),
    video("videoService"),
    other("otherService");

    private final String serviceName;

    Category(String serviceName) {
        this.serviceName = serviceName;
    }
}
```
---

## ğŸŒ± Spring ë¹ˆì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì!

- ì–´ë–»ê²Œ ì „ëµ íŒ¨í„´ì„ ì‚¬ìš©í•´ì„œ ì›í•˜ëŠ” ì„œë¹„ìŠ¤ ì „ëµì„ ì„ íƒí•  ìˆ˜ ìˆëŠ” ê±´ì§€ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤!!

ë”°ë¼ì„œ scrapServicesì—ëŠ” ì–´ë– í•œ ê²ƒë“¤ì´ ë‹´ê²¨ìˆëŠ”ì§€ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.

ì´ë¥¼ ìœ„í•´ì„œ `System.out.println("scrapServiceMap: " + scrapServiceMap);` ì¶œë ¥í•˜ëŠ” ë¬¸ì¥ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.

```java
@RequiredArgsConstructor
@RestController
public class ScrapController {

    private final Map<String, ScrapService> scrapServices;

    @GetMapping("/v1/scraps/{category}/count")
    public ApiResponse<GetScrapCountResponse> getScrapCount(
            @NotNull @PathVariable Category category,
            Authentication authentication) {
        String email = authentication.getName();


        for (ScrapService scrapServiceMap : scrapServices.values()) {
            System.out.println("scrapServiceMap: " + scrapServiceMap);
        }

        ScrapService scrapService = scrapServices.get(category.getServiceName());

        Long scrapCount = scrapService.getScrapCount(email);
        return ApiResponse.success(GetScrapCountResponse.of(scrapCount));
    }
}
```

![Alt text](/assets/img/2023-09-16/image-4.png)

- ì¦‰, ì—¬ê¸°ì—ëŠ” ScrapService ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ArticleService, OtherService, PlaceService, ProductService, VideoServiceì´ ë‹´ì•„ì¡ŒìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `private final Map<String, ScrapService> scrapServices;`
    - mapì˜ í‚¤ì— ìŠ¤í”„ë§ ë¹ˆì˜ ì´ë¦„ì„ ë„£ì–´ì£¼ê³ , ê·¸ ê°’ìœ¼ë¡œ  ScrapService íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•œ ëª¨ë“  ìŠ¤í”„ë§ ë¹ˆì„ ë‹´ì•„ì¤ë‹ˆë‹¤.
- ì´ ì¤‘ì—ì„œ ë™ì¼í•œ ì´ë¦„ì˜ Serviceë¥¼ scrapServices.get(category.getServiceName())í•´ì„œ ê°€ì ¸ì˜¤ê³  ì‚¬ìš©í•´ì¤ë‹ˆë‹¤.

---

## í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±í•˜ê¸°
```java
@Test
@WithCustomMockUser
public void should_it_returns_the_number_of_saved_videos_When_getting_the_number_of_videos() throws Exception {
    // ë¹„ë””ì˜¤ ê°œìˆ˜ ì¡°íšŒì‹œ ì €ì¥ëœ ë¹„ë””ì˜¤ì˜ ê°œìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ”ì§€ í™•ì¸
    mockMvc.perform(get("/v1/scraps/video/count")
                    .header("X-AUTH-TOKEN", "aaaaaaa"))
            .andExpect(MockMvcResultMatchers.status().isOk())
            .andExpect(MockMvcResultMatchers.jsonPath("$.data.count").value(2L));
}
```

![Alt text](/assets/img/2023-09-16/image-3.png)

ìœ„ì˜ ì‘ì„±í•˜ì—¬ ì¹´í…Œê³ ë¦¬ë³„ ìŠ¤í¬ë© ê°œìˆ˜ ì¡°íšŒí•˜ëŠ” Controllerë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ, ë™ì¼í•œ ê¸°ëŠ¥ì˜ í•µì‹¬ ë¡œì§ì„ í•˜ë‚˜ì˜ í…ŒìŠ¤íŠ¸ë§Œìœ¼ë¡œ ê¸°ëŠ¥ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆê³ , ì•ìœ¼ë¡œëŠ” ê°™ì€ ê¸°ëŠ¥ê³¼ ë¡œì§ì— ëŒ€í•´ì„œëŠ” ë™ì¼í•œ ë¡œì§ì˜ ê²€ì¦ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì—¬ëŸ¬ ê°œ ì‘ì„±í•˜ì§€ ì•Šê³  ë‹¤ë¥¸ ì—ëŸ¬ ì²˜ë¦¬ì™€ ê°™ì€ í…ŒìŠ¤íŠ¸ ë˜ì§€ ì•Šì€ ë¶€ë¶„ì„ ë” êµ¬ì²´ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ” SOLID ê°ì²´ ì§€í–¥ 5ê°€ì§€ ì„¤ê³„ ì›ì¹™ ì‚´í´ë³´ê¸°

ifë¬¸ ì ìš©í•˜ê¸°ì—ì„œ ifë¬¸ì„ ì‚¬ìš©í•˜ë©´ SOLID ì›ì¹™ ì¤‘ Oì™€ Dì— í•´ë‹¹í•˜ëŠ” ì›ì¹™ì„ ì–´ê¸°ê²Œ ëœë‹¤ê³  ì´ì•¼ê¸°í–ˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë©´ ì „ëµ íŒ¨í„´ì„ ì ìš©í–ˆì„ ë•Œì—ëŠ” ê³¼ì—° ì›ì¹™ì„ ì˜ ì§€í‚¤ê³  ìˆëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤!

1. ScrapControllerê°€ ScrapService ì¸í„°í˜ì´ìŠ¤ë¥¼ ì˜ì¡´í•˜ê³  ìˆê¸° ë•Œë¬¸ì— DIP ì˜ì¡´ê´€ê³„ ì—­ì „ ì›ì¹™ì„ ì§€í‚¬ ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
![Alt text](/assets/img/2023-09-16/image-7.png)

2. ì¹´í…Œê³ ë¦¬ê°€ ì¶”ê°€ë˜ì–´ë„ ì•„ë˜ì˜ ì½”ë“œëŠ” ë³€í™”ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— OCP ê°œë°œ íì‡„ ì›ì¹™ì„ ì§€í‚¤ê²Œ ë©ë‹ˆë‹¤.

```java
@RequiredArgsConstructor
@RestController
public class ScrapController {

    private final Map<String, ScrapService> scrapServices;

    @GetMapping("/v1/scraps/{category}/count")
    public ApiResponse<GetScrapCountResponse> getScrapCount(
            @NotNull @PathVariable Category category,
            Authentication authentication) {
        String email = authentication.getName();

        ScrapService scrapService = scrapServices.get(category.getServiceName());

        Long scrapCount = scrapService.getScrapCount(email);
        return ApiResponse.success(GetScrapCountResponse.of(scrapCount));
    }
}
```

---

# 3ï¸âƒ£ ê²°ë¡ 

- í˜„ì¬ ë°°ìš°ê³  ìˆëŠ” GoF ë””ìì¸ íŒ¨í„´ ì¤‘ í•˜ë‚˜ì¸ ì „ëµ íŒ¨í„´ì„ ì§ì ‘ í”„ë¡œì íŠ¸ì— ì ìš©í•´ë³´ê²Œ ë  ìˆ˜ ìˆì–´ì„œ ëœ»ê¹Šì€ ì‹œê°„ì´ì—ˆìŠµë‹ˆë‹¤.
- ì´ëŸ¬í•œ ë¦¬íŒ©í† ë§ì„ ì‹œì‘í•˜ê¸° ì „ì—ëŠ” ì–´ë– í•œ ì„œë¹„ìŠ¤ë¥¼ ì˜ë¯¸í•˜ëŠ”ì§€ ëª¨ë¥´ê²Œ ë˜ê³  ì½”ë“œì— ëŒ€í•œ ê°€ë…ì„±ì´ ë–¨ì–´ì§€ê²Œ ë˜ë©° ë””ìì¸ íŒ¨í„´ì„ ì ìš©í•˜ê³ ì í•˜ëŠ” ë‚˜ì˜ ìš•ì‹¬ì´ ì•„ë‹ê¹Œë¼ëŠ” ìƒê°ì´ ë“¤ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜, ì´ì „ê¹Œì§€ëŠ” ìŠ¤í¬ë©ì˜ ì¹´í…Œê³ ë¦¬ê°€ ìƒí’ˆ, ì˜ìƒ, ì•„í‹°í´, ê¸°íƒ€ê¹Œì§€ë§Œ ìˆì—ˆëŠ”ë° ì´ë²ˆì— ìƒí’ˆ ì¹´í…Œê³ ë¦¬ë¥¼ ëŠ˜ë¦¬ê²Œ ë˜ë©´ì„œ ì•ìœ¼ë¡œ ì¹´í…Œê³ ë¦¬ê°€ ëŠ˜ì–´ë‚  ìˆ˜ ìˆë‹¤ëŠ” ìƒê°ì„ í•˜ê²Œ ë˜ì—ˆê³  ê·¸ëŸ¬ë©´ ì•ìœ¼ë¡œ ê¸°ëŠ¥ ì¶”ê°€ ë° ìœ ì§€ë³´ìˆ˜ë¥¼ ìœ„í•´ì„œë¼ë„ ì „ëµ íŒ¨í„´ì„ ì‚¬ìš©í•´ì•¼ê² ë‹¤ëŠ” ë‹¤ì§ì„ í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì‹¤ì œë¡œ ë¦¬íŒ©í† ë§ì„ í•˜ë©´ì„œ í…ŒìŠ¤íŠ¸ ì½”ë“œì™€ ìœ ì§€ë³´ìˆ˜ ì¸¡ë©´ ë“± ì—¬ëŸ¬ ê°€ì§€ì˜ ì¥ì ì´ ìˆëŠ” ê²ƒì„ ëŠë¼ê³  ë¦¬íŒ©í† ë§ì„ í•˜ê¸°ë¥¼ ì˜ í–ˆë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤.
- ê·¸ë¦¬ê³  ì´ ë¸”ë¡œê·¸ë¥¼ ì‘ì„±í•˜ëŠ” ì´ìœ  ì¤‘ í•˜ë‚˜ê°€ íŒ€ì›ë“¤ì—ê²Œ í•´ë‹¹ ë¦¬íŒ©í† ë§ ê³¼ì •ì„ ì†Œê°œí•˜ê³  ì¥ì ì— ëŒ€í•´ì„œ ì†Œê°œí•œ ë’¤ì— ì‹¤ì œ í”„ë¡œì íŠ¸ì—ë„ ë„ì…í•˜ìê³  ì œì•ˆí•˜ê¸° ìœ„í•´ì„œ ì‘ì„±ëœ ì´ìœ ë„ ìˆëŠ” ë§Œí¼ ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œ ë¦¬íŒ©í† ë§ì„ ë„ì…ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ë°”ë¨ìœ¼ë¡œ ì´ê¸€ì„ ì‘ì„±í•©ë‹ˆë‹¤ ğŸŒ¸